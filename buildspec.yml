version: 0.2
phases:
  install:
    commands:
      # needed for latest awscli
      - echo "executing install commands"
      - curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -
      - apt-get install -y nodejs
      - npm install -g @angular/cli
  pre_build:
    commands:
      - echo "executing pre_build commands"
      - cd imagine-universal; npm install; npm run build:ssr
  build:
    commands:
      - echo "executing build commands"
      - docker-compose build
  post_build:
    commands:
      - echo "executing post_build commands"
      - docker-compose push
      #- aws s3 sync --acl public-read --sse --delete src/ng5IoTDashboard/dist/ s3://$STATIC_WEBSITE_BUCKET
      #- aws cloudfront create-invalidation --distribution-id $CLOUDFRONT_DISTRIBUTION --paths '/*'
